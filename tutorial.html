<html>  <head>    <meta http-equiv="content-type" content="text/html; charset=UTF-8">  </head>  <body bgcolor="Silver">    <p></p>    <h1>RapaNui tutorial:</h1>    <p></p>    <p></p>    <h2>Setting up Physics Editor using the RapaNui framework</h2>    <p></p>    <br>
    <p>As Prerequisite you should already know how to correctly run RapaNui's framework examples.Check the README under your RapaNui copy.</p>    <p>Let's create a simple demo of falling physics objects. </p>    <p></p>    <h3>1:Try the demo</h3>    <p></p>    <p></p>    <p>To run the demo simply replace the RapaNui's default <strong>main.lua</strong> and <strong> config.lua</strong> with the ones in the tutorial directory.</p>
    <p>Also add to your RapaNui main directory the folder <strong> resources </strong> given with this demo.</p>    <p>If you run the demo it should look like this:</p>    <img src="tutorial_physics_editor/html_res/demo.png" align="middle">    <br>    <p></p>    <h3>2: Let's write the code step by step</h3>    <h3>      <p></p>      <p></p>    </h3>    <h4>What to do:</h4>    <p></p>    <p>In your favourite lua editor open main.lua and the config.lua which is in      the same directory (do not open files with the same names in moaibuild      directories). </p>    <p>What's inside this two files: config.lua contains the setup for the      screensize and main.lua contains the code of the demo.</p>    <br>    <p></p>    <h4>Setting screen size:</h4>    <p></p>    <p>This demo runs in a 580x410 window. The <strong>config.lua</strong> in      the example directory, the same directory as <strong>main.lua</strong>,      will handle this with:</p>    <p></p>    <pre><code>module(..., package.seeall)
sizes = {}
sizes["PE_Demo"]={580,410,580,410}
landscape = false
device = "PE_Demo"</code></pre>    <p></p>
    <p>As you can see from the code above, we set a size for the screen to be viewed and the landscape mode as false. A window 580x410 will be opened.</p>
    <p>The table inside table named "PE_Demo" contains the screen size.</p>    <p>That's it, we have done with congif.lua</p>    <br>    <p></p>    <h4>Importing the correct files:</h4>    <p></p>    <p>Now let's write the real demo, on <strong>main.lua </strong>file. Let's      see imports:</p>    <p><code></code></p>    <pre><code>require("RNFactory")require("RNListeners")require("RNPhysics")require("RNMainThread")require("RNThread")</code></pre>    <p></p>    <p>The above lines load the correct files from RapaNui framework.</p>    <p>RNlisteners, RNMainThread and RNThread are used to call actions which      make objects to fall.</p>    <p>RNPhysics will handle the physics world and simulation.</p>    <p>RNFactory will help in creating RapaNui objects.</p>    <br>    <p></p>    <h4>Starting the physics simulation</h4>    <p></p>    <p>Physics simulation is simply started with:    </p>    <p><code>RNPhysics.start()</code></p>    <p>Now the Physics world is created and running.</p>    <br>    <p></p>    <h4>Creating a background image</h4>    <p></p>    <p>Thanks to RNFactory we can easily add images with:</p>    <p><code>RNFactory.createImage("resources/bkg_cor.png");</code></p>    <br>    <p></p>    <h4>Loading Physics Editor datas:</h4>    <p></p>    <p>To create Physics Editor's objects we need to first load PE's data from      the published file for rapanui(check resources dir):</p>    <p><code>local physicsData = (require"resources/PhysicsData").physicsData()</code></p>    <p>We store this data in the local variable "physicsData", to use it later.</p>    <br>    <p></p>    <h4>Creating the floor</h4>    <p></p>    <p>Now we have all PE's data stored in "physicsData" we can create all the      objects we want with the information from PhysicsData.lua</p>    <p>To create a floor we need to: <br>    </p>    <p>1) Create the image<br>      2) Move and optionally name it <br>      3) Make the floor a physics object. <br>    </p>    <p>3 lines are enough for this:</p>    <p><code></code></p>    <pre><code>local floorImage = RNFactory.createImage("resources/floor.png");floorImage.x = 290; floorImage.y = 375; floorImage.name = "floor"RNPhysics.createBodyFromImage(floorImage, "static", physicsData:get("floor"))</code></pre>    <p></p>    <p>line 1 creates the floor. <br>      line 2 moves and renames it (else its name would have been "floor.png").<br>      line 3 creates a body from the given image and physics data with the      optional type attribute "static" (needed for a static floor).</p>    <p>"physicsData:get("floor")" means we are loading all the information under      the name "floor" from physicsData.</p>    <p>At this point the demo, if everything is fine, will look like:</p>    <img src="tutorial_physics_editor/html_res/demo2.png" align="middle">    <p>And the code will look like:</p>    <p><code></code></p>    <pre><code>require("RNFactory")require("RNListeners")require("RNPhysics")require("RNMainThread")require("RNThread")RNPhysics.start()RNFactory.createImage("resources/bkg_cor.png");local physicsData = (require"resources/PhysicsData").physicsData()local floorImage = RNFactory.createImage("resources/floor.png");floorImage.x = 290; floorImage.y = 375; floorImage.name = "floor"RNPhysics.createBodyFromImage(floorImage, "static", physicsData:get("floor"))</code></pre>    <p></p>    <br>    <p></p>    <h4>Creating falling objects:</h4>    <p></p>    <p>To create falling objects we need a function to be called repeatedly      which will spawn random objects from a table of elements.</p>    <p>It won't be so hard because images names are the same as the ones in      physicsData, and I suggest you to do it always this way. So we can create      our table:</p>    <p><code></code></p>    <pre><code>local foodTable = { 'drink', 'hamburger', 'hotdog', 'icecream', 'icecream2', 'icecream3' }</code></pre>    <p></p>    <p>And now we can write a function to take a random item from this table and      create a physics object:</p>    <p><code></code></p>    <pre><code>function createFallingObjects()    local item = foodTable[math.random(#foodTable)]    local object = RNFactory.createImage("resources/" .. item .. ".png");    object.x = math.random(580);    object.name = item    RNPhysics.createBodyFromImage(object, physicsData:get(item))end</code></pre>    <p></p>    <p>Objects are created as the same way as the floor: we create an image, if      we want we move it and rename it, so we make the image a physics object      giving the factory the image and the correct data from PhysicsEditor      storing variable(this time we don't need to specify "static" or "dynamic",      by default objects are created with the "dynamic" attribute)</p>    <p>Now if we call the above function we'll see a random object falling down:</p>    <p><code>createFallingObjects()      </code></p>    <p>But our function has to be called repeatedly, so we need to call a      RapaNui's timed action to handle this:</p>    <p><code>RNMainThread.addTimedAction(2000, createFallingObjects, -1)</code></p>    <p>As you can imagine the above line loop repeats (beacuse of "-1")      createFallingObjects() each 2000 time steps.</p>    <br>    <p></p>    <h4>The final result:</h4>    <p></p>    <p>As a final result, if we remove all the comments thanks to RapaNui, Moai      and PhysicsEditor we can create a complex physics world with just 20 lines      of code!</p>    <p>Here the code without comments:</p>    <p><code></code></p>    <pre><code>require("RNFactory")require("RNListeners")require("RNPhysics")require("RNMainThread")require("RNThread")RNPhysics.start()RNFactory.createImage("resources/bkg_cor.png");local physicsData = (require"resources/PhysicsData").physicsData()local floorImage = RNFactory.createImage("resources/floor.png");floorImage.x = 290; floorImage.y = 375; floorImage.name = "floor"RNPhysics.createBodyFromImage(floorImage, "static", physicsData:get("floor"))local foodTable = { 'drink', 'hamburger', 'hotdog', 'icecream', 'icecream2', 'icecream3' }function createFallingObjects()    local item = foodTable[math.random(#foodTable)]    local object = RNFactory.createImage("resources/" .. item .. ".png");    object.x = math.random(580);    object.name = item    RNPhysics.createBodyFromImage(object, physicsData:get(item))endcreateFallingObjects()RNMainThread.addTimedAction(2000, createFallingObjects, -1)</code></pre>    <p></p>    <p>And if we run the demo we should see something like:</p>    <img src="tutorial_physics_editor/html_res/demo.png" align="middle">    <br>
    <p>Now you can try some changes to code and to shapedefs.pes and see what happen!</p>    <br>    <p>Thank you for using Physics Editor and RapaNui.</p>    <br>    <br>
        <p><a href="http://www.physicseditor.de/">http://www.physicseditor.de/
</a></p>
    <p><a href="https://github.com/ymobe/rapanui">https://github.com/ymobe/rapanui</a></p>
    <p><a href="http://ymobe.com/">http://ymobe.com/</a></p>
    <br>    tutorial by RapaNui Team  </body></html>